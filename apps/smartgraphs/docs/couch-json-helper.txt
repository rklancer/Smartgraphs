Rough sketch of the helper function for generating JSON of activity A:


Given an activity step A:

  get Activity record A
  store record A in the hash under key 'activity' (?)
  
  get every ActivityPage record P referenced in the 'pages' property of A
  store records P under key 'activityPages'
  
  get every activity step
  
  get all dataset records D whose url prefix is the activity A
  store under key 'dataset'
  
    get all datapoint records DP referenced by D
    store under key 'dataPoints' in 'dataset' record
    * may have to convert numeric key to a string?
  

  get all Graph records G whose 'activity' property is the activity A
  store under key 'graph'
  
    get all of Axes X referenced by graphs in G
    store X under key 'axes'
  

  get freehand sketch records F whose url prefix is the activity A
  store under key 'freehandSketch'

  get all highlighted points whose url prefix is the activity A

  get all highlighted segments whose url prefix is the activity A

  get all line-to-axis records whose url prefix is A
    
  get an ad hoc set of response templates (there's no automatic way to tell which are associated with A)
  
  
These are the models we need to include the in the JSON document:  

  Activity: 
  ActivityPages:
  ActivityStep
  Axes
  DataPoint (for example data)
  Dataset (for example data)
  FreehandSketch
  Graph
  HighlightedPoint
  HighlightedSegment
  LineToAxis
  ResponseTemplate

  * leave User in fixtures; or just modify LOGIN state to create default "user" dynamically


----

1. change the current data source to call the callbacks without using settimeout (or just look at mockResponses directly)

2. 